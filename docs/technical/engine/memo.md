## 構文解析
ソースコードをパーサーで解析する。パーサーはAST(ast::Nodeによる木構造)を生成する。  
ASTでは構造体のサイズを確定させるために、ノードの中に別のノードを入れる場合はBoxやVecで囲んでいる。

## 静的解析
ASTをトラバースして、識別子が存在するかどうかや型の矛盾がないかどうかを確認する。  
識別子の解決に必要な情報や型情報は解析スタックに収集する。  
識別子を見つけた場合は、解析スタックから対応する関数や変数へ関連付けを行う。  
静的解析ではグラフノード(graph::Node)を生成する。グラフノードでは識別子の代わりにノードIDを使って他のノードを参照できるようになる。

### 解析スタック
識別子とグラフノードのペアを解析スタックに登録する。  
そのスコープに存在する全ての識別子と、対応するグラフノードの情報(型やソースコード上の位置など)にアクセスできる。  
解析スタックの構造はレイヤー状になっている。1つのレイヤーには複数のレコードを登録できる。  
現在のレイヤーから親のレイヤーには遡ってアクセスできる。子のレイヤーにはアクセスできない。

### 型チェック
TODO

### if文
パーサーではできるだけ間違った並びでも読み取るようにして、静的解析でエラーを検出する。  
静的解析でelse if部分をelseのブロックの中にif文がネストしている形としてデシュガーする。

イメージ:
```ts
// before
if cond {

} else if cond {

} else if cond {

} else {

}

// after
if cond {

} else {
    if cond {

    } else {
        if cond {

        } else {

        }
    }
}
```

## インタプリタによる実行
静的解析で生成したグラフをトラバースして処理を実行する。  

### 実行スタック
実行スタックに変数などの値を追加していく。実行スタックの項目はシンボルと呼ぶ。  
グラフノードのIDをシンボルアドレスとして使う。

### 参照のグラフノードにおけるシンボル操作
参照のグラフノードを見つけた時は、参照先が参照ノードではなくなるまで参照先の解決を試みる。  
参照先が見つかったら、そのノードIDをシンボルアドレスとして、シンボルの操作を行う。
